{
  "$ref": "#/definitions/AWSConfiguration",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "definitions": {
    "AWSAccessKeyId": {
      "description": "Access key for this user.",
      "pattern": "^[^\\s]*$",
      "title": "AWS Access Key Id",
      "type": "string"
    },
    "AWSAccessKeyIdVariableName": {
      "description": "Name of environment variable for AWS Access Key Id. When in doubt, use AWS_ACCESS_KEY_ID.",
      "pattern": "^[^\\s]*$",
      "title": "AWS Access Key Id Variable Name",
      "type": "string"
    },
    "AWSConfiguration": {
      "additionalProperties": false,
      "description": "Global configuration for deploying to AWS.",
      "properties": {
        "users": {
          "$ref": "#/definitions/AWSUsers"
        }
      },
      "required": [
        "users"
      ],
      "title": "AWS Configuration",
      "type": "object"
    },
    "AWSDefaultRegionVariableName": {
      "description": "Name of environment variable for AWS Default Region. When in doubt, use AWS_DEFAULT_REGION.",
      "pattern": "^[^\\s]*$",
      "title": "AWS Default Region Varialbe Name",
      "type": "string"
    },
    "AWSDeploymentRegion": {
      "description": "AWS region that infrastructure should be deployed to.",
      "enum": [
        "us-east-1",
        "us-east-2",
        "us-west-1",
        "us-west-2",
        "af-south-1",
        "ap-east-1",
        "ap-south-1",
        "ap-northeast-3",
        "ap-northeast-2",
        "ap-southeast-1",
        "ap-southeast-2",
        "ap-northeast-1",
        "ca-central-1",
        "eu-central-1",
        "eu-west-1",
        "eu-west-2",
        "eu-south-1",
        "eu-west-3",
        "eu-north-1",
        "me-south-1",
        "sa-east-1"
      ],
      "title": "AWS Deployment Region",
      "type": "string"
    },
    "AWSRegion": {
      "$ref": "#/definitions/AWSDeploymentRegion",
      "description": "Default AWS region to use.",
      "pattern": "^[^\\s]*$",
      "title": "AWS Region"
    },
    "AWSSecretAccessKey": {
      "description": "Secret key for this user.",
      "pattern": "^[^\\s]*$",
      "title": "AWS Secret Access Key",
      "type": "string"
    },
    "AWSSecretAccessKeyVariableName": {
      "description": "Name of environment variable for AWS Secret Access Key. When in doubt, use AWS_SECRET_ACCESS_KEY.",
      "pattern": "^[^\\s]*$",
      "title": "AWS Secret Access Key Variable Name",
      "type": "string"
    },
    "AWSUser": {
      "additionalProperties": false,
      "description": "AWS user",
      "properties": {
        "config": {
          "$ref": "#/definitions/AwsUserConfig"
        },
        "name": {
          "$ref": "#/definitions/Name"
        },
        "type": {
          "$ref": "#/definitions/Type"
        }
      },
      "required": [
        "name",
        "type",
        "config"
      ],
      "title": "AWS User",
      "type": "object"
    },
    "AWSUsers": {
      "items": {
        "$ref": "#/definitions/AWSUser"
      },
      "type": "array"
    },
    "AwsUserConfig": {
      "anyOf": [
        {
          "additionalProperties": false,
          "properties": {
            "profile": {
              "$ref": "#/definitions/Profile"
            },
            "terraformStateBucket": {
              "$ref": "#/definitions/TerraformStateBucket"
            },
            "terraformStateDynamoDBTable": {
              "$ref": "#/definitions/TerraformDynamoDBTable"
            }
          },
          "required": [
            "profile"
          ],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "awsAccessKeyIdVariableName": {
              "$ref": "#/definitions/AWSAccessKeyIdVariableName"
            },
            "awsDefaultRegionVariableName": {
              "$ref": "#/definitions/AWSDefaultRegionVariableName"
            },
            "awsSecretAccessKeyVariableName": {
              "$ref": "#/definitions/AWSSecretAccessKeyVariableName"
            },
            "terraformStateBucket": {
              "$ref": "#/definitions/TerraformStateBucket"
            },
            "terraformStateDynamoDBTable": {
              "$ref": "#/definitions/TerraformDynamoDBTable"
            }
          },
          "required": [
            "awsAccessKeyIdVariableName",
            "awsDefaultRegionVariableName",
            "awsSecretAccessKeyVariableName"
          ],
          "type": "object"
        },
        {
          "additionalProperties": false,
          "properties": {
            "awsAccessKeyId": {
              "$ref": "#/definitions/AWSAccessKeyId"
            },
            "awsDefaultRegion": {
              "$ref": "#/definitions/AWSRegion"
            },
            "awsSecretAccessKey": {
              "$ref": "#/definitions/AWSSecretAccessKey"
            },
            "terraformStateBucket": {
              "$ref": "#/definitions/TerraformStateBucket"
            },
            "terraformStateDynamoDBTable": {
              "$ref": "#/definitions/TerraformDynamoDBTable"
            }
          },
          "required": [
            "awsDefaultRegion"
          ],
          "type": "object"
        }
      ]
    },
    "Name": {
      "description": "Identifier for this user. No spaces allowed.",
      "pattern": "^[^\\s]*$",
      "title": "Name",
      "type": "string"
    },
    "Profile": {
      "description": "Profile name of the user configured with the aws cli. When in doubt, use `default`.",
      "pattern": "^[^\\s]*$",
      "title": "Profile",
      "type": "string"
    },
    "TerraformDynamoDBTable": {
      "description": "The name of the DynamoDB table used for Terraform state locking. If not provided, will be auto-generated on first deployment.",
      "pattern": "^[^\\s]*$",
      "title": "Terraform DynamoDB Table",
      "type": "string"
    },
    "TerraformStateBucket": {
      "description": "The name of the bucket where the Terraform state for the packages will be stored.\nIf not provided, will be auto-generated on first deployment.",
      "pattern": "^[^\\s]*$",
      "title": "Terraform State Bucket",
      "type": "string"
    },
    "Type": {
      "description": "Type of this user.",
      "enum": [
        "apiKey",
        "local",
        "environmentVariables"
      ],
      "title": "Type",
      "type": "string"
    }
  }
}